2025-12-14 19:17:42,713 - INFO - ============================================================
2025-12-14 19:17:42,713 - INFO - PROTOTYPE STEP 0: CREATE SUBSET MATRICES
2025-12-14 19:17:42,713 - INFO - ============================================================
2025-12-14 19:17:42,713 - INFO - 
2025-12-14 19:17:42,715 - INFO - Configuration loaded from config_proto.yaml
2025-12-14 19:17:42,715 - INFO - Output directory: /Users/daisy.c.gunawan/Documents/FYP I 2025/fyp_code/prototype/input/preprocessed/matrices
2025-12-14 19:17:42,715 - INFO - 
2025-12-14 19:17:42,715 - INFO - Step 1: Locating source matrices from config
2025-12-14 19:17:42,715 - INFO - ----------------------------------------
2025-12-14 19:17:42,715 - INFO - Source directory: ../output/00_b_data_preprocess/matrices
2025-12-14 19:17:42,715 - INFO - Tumor file: tumor_matrix.tsv
2025-12-14 19:17:42,715 - INFO - Normal file: normal_matrix.tsv
2025-12-14 19:17:42,715 - INFO - 
2025-12-14 19:17:42,715 - INFO - Found source matrix: /Users/daisy.c.gunawan/Documents/FYP I 2025/fyp_code/output/00_b_data_preprocess/matrices/tumor_matrix.tsv
2025-12-14 19:17:42,715 - INFO - Found source matrix: /Users/daisy.c.gunawan/Documents/FYP I 2025/fyp_code/output/00_b_data_preprocess/matrices/normal_matrix.tsv
2025-12-14 19:17:42,715 - INFO - 
2025-12-14 19:17:42,715 - INFO - Step 2: Loading full tumor matrix
2025-12-14 19:17:42,715 - INFO - ----------------------------------------
2025-12-14 19:17:42,715 - INFO - Loading full matrix: tumor_matrix.tsv
2025-12-14 19:17:42,715 - INFO -   From: ../output/00_b_data_preprocess/matrices
2025-12-14 19:17:43,989 - INFO -   Shape: 13384 genes × 1118 samples
2025-12-14 19:17:44,000 - INFO -   Memory: 120.7 MB
2025-12-14 19:17:44,001 - INFO - 
2025-12-14 19:17:44,001 - INFO - Step 3: Creating tumor subset (120 samples)
2025-12-14 19:17:44,001 - INFO - ----------------------------------------
2025-12-14 19:17:44,003 - INFO - Selected 120 tumor samples
2025-12-14 19:17:44,006 - INFO -   Subset size: 13.8 MB
2025-12-14 19:17:44,896 - INFO - Saved to: input/preprocessed/matrices/tumor_matrix.tsv
2025-12-14 19:17:44,896 - INFO -   File size: 29.7 MB
2025-12-14 19:17:44,899 - INFO - 
2025-12-14 19:17:44,899 - INFO - Step 4: Loading full normal matrix
2025-12-14 19:17:44,899 - INFO - ----------------------------------------
2025-12-14 19:17:44,899 - INFO - Loading full matrix: normal_matrix.tsv
2025-12-14 19:17:44,899 - INFO -   From: ../output/00_b_data_preprocess/matrices
2025-12-14 19:17:45,045 - INFO -   Shape: 13384 genes × 113 samples
2025-12-14 19:17:45,048 - INFO -   Memory: 13.1 MB
2025-12-14 19:17:45,048 - INFO - 
2025-12-14 19:17:45,048 - INFO - Step 5: Creating normal subset (40 samples)
2025-12-14 19:17:45,048 - INFO - ----------------------------------------
2025-12-14 19:17:45,048 - INFO - Selected 40 normal samples
2025-12-14 19:17:45,050 - INFO -   Subset size: 5.3 MB
2025-12-14 19:17:45,348 - INFO - Saved to: input/preprocessed/matrices/normal_matrix.tsv
2025-12-14 19:17:45,348 - INFO -   File size: 10.1 MB
2025-12-14 19:17:45,348 - INFO - 
2025-12-14 19:17:45,348 - INFO - Step 6: Verifying gene consistency
2025-12-14 19:17:45,348 - INFO - ----------------------------------------
2025-12-14 19:17:45,348 - INFO - Gene sets match: 13384 genes
2025-12-14 19:17:45,348 - INFO - 
2025-12-14 19:17:45,348 - INFO - Step 7: Saving subset metadata
2025-12-14 19:17:45,348 - INFO - ----------------------------------------
2025-12-14 19:17:45,349 - INFO - Metadata saved to: input/preprocessed/matrices/subset_metadata.json
2025-12-14 19:17:45,349 - INFO - 
2025-12-14 19:17:45,349 - INFO - ============================================================
2025-12-14 19:17:45,350 - INFO - STEP 0 COMPLETE
2025-12-14 19:17:45,350 - INFO - ============================================================
2025-12-14 19:17:45,350 - INFO - Total execution time: 2.6 seconds
2025-12-14 19:17:45,350 - INFO - 
2025-12-14 19:17:45,350 - INFO - Subset matrices created:
2025-12-14 19:17:45,350 - INFO -   • input/preprocessed/matrices/tumor_matrix.tsv (29.7 MB)
2025-12-14 19:17:45,350 - INFO -   • input/preprocessed/matrices/normal_matrix.tsv (10.1 MB)
2025-12-14 19:17:45,350 - INFO -   • input/preprocessed/matrices/subset_metadata.json
2025-12-14 19:17:45,350 - INFO - 
2025-12-14 19:17:45,350 - INFO - Space saved: ~260 MB
2025-12-14 19:17:45,350 - INFO - 
2025-12-14 19:17:45,350 - INFO - Next step: python scripts/proto_01_prepare_data.py
2025-12-14 19:17:45,350 - INFO - ============================================================
2025-12-14 19:17:46,123 - INFO - ============================================================
2025-12-14 19:17:46,123 - INFO - PROTOTYPE STEP 1: DATA PREPARATION & CORRELATION
2025-12-14 19:17:46,123 - INFO - ============================================================
2025-12-14 19:17:46,123 - INFO - 
2025-12-14 19:17:46,125 - INFO - Configuration loaded from config_proto.yaml
2025-12-14 19:17:46,125 - INFO - Step 1: Loading expression matrices
2025-12-14 19:17:46,125 - INFO - ----------------------------------------
2025-12-14 19:17:46,125 - INFO - Loading matrix from: input/preprocessed/matrices/tumor_matrix.tsv
2025-12-14 19:17:46,269 - INFO -   Shape: 13384 genes × 120 samples
2025-12-14 19:17:46,272 - INFO -   Memory: 13.8 MB
2025-12-14 19:17:46,272 - INFO - Loading matrix from: input/preprocessed/matrices/normal_matrix.tsv
2025-12-14 19:17:46,327 - INFO -   Shape: 13384 genes × 40 samples
2025-12-14 19:17:46,329 - INFO -   Memory: 5.3 MB
2025-12-14 19:17:46,329 - INFO - 
2025-12-14 19:17:46,329 - INFO - Gene sets match: 13384 genes
2025-12-14 19:17:46,329 - INFO - 
2025-12-14 19:17:46,329 - INFO - Step 2: Selecting sample subset
2025-12-14 19:17:46,329 - INFO - ----------------------------------------
2025-12-14 19:17:46,329 - INFO - Selecting random subset: 120 tumor + 40 normal samples
2025-12-14 19:17:46,331 - INFO - Selected 120 tumor + 40 normal samples
2025-12-14 19:17:46,332 - INFO - Sample info saved to: output/correlation_matrices/sample_info.json
2025-12-14 19:17:46,332 - INFO - 
2025-12-14 19:17:46,332 - INFO - Step 3: Computing tumor correlation matrix
2025-12-14 19:17:46,332 - INFO - ----------------------------------------
2025-12-14 19:17:46,332 - INFO - Computing spearman correlation matrix...
2025-12-14 19:17:46,332 - INFO -   Matrix shape: 13384 genes × 120 samples
2025-12-14 19:17:46,332 - INFO -   Total pairs to compute: 89,559,036
2025-12-14 19:18:17,403 - INFO - Correlation computed in 31.1 seconds
2025-12-14 19:18:17,409 - INFO -   Output shape: (13384, 13384)
2025-12-14 19:18:17,460 - INFO -   Correlation range: [-0.667, 1.000]
2025-12-14 19:18:18,232 - INFO -   Mean absolute correlation: 0.203
2025-12-14 19:18:41,569 - INFO - Saved to: output/correlation_matrices/tumor_corr_proto.npz
2025-12-14 19:18:41,570 - INFO -   File size: 638.2 MB
2025-12-14 19:18:41,570 - INFO - 
2025-12-14 19:18:41,570 - INFO - Step 4: Computing normal correlation matrix
2025-12-14 19:18:41,570 - INFO - ----------------------------------------
2025-12-14 19:18:41,570 - INFO - Computing spearman correlation matrix...
2025-12-14 19:18:41,570 - INFO -   Matrix shape: 13384 genes × 40 samples
2025-12-14 19:18:41,570 - INFO -   Total pairs to compute: 89,559,036
2025-12-14 19:19:18,303 - INFO - Correlation computed in 36.7 seconds
2025-12-14 19:19:18,305 - INFO -   Output shape: (13384, 13384)
2025-12-14 19:19:18,354 - INFO -   Correlation range: [-0.936, 1.000]
2025-12-14 19:19:19,017 - INFO -   Mean absolute correlation: 0.420
2025-12-14 19:19:37,210 - INFO - Saved to: output/correlation_matrices/normal_corr_proto.npz
2025-12-14 19:19:37,210 - INFO -   File size: 455.7 MB
2025-12-14 19:19:37,211 - INFO - 
2025-12-14 19:19:37,211 - INFO - ============================================================
2025-12-14 19:19:37,211 - INFO - STEP 1 COMPLETE
2025-12-14 19:19:37,211 - INFO - ============================================================
2025-12-14 19:19:37,211 - INFO - Total execution time: 111.1 seconds (1.9 minutes)
2025-12-14 19:19:37,211 - INFO - 
2025-12-14 19:19:37,211 - INFO - Outputs generated:
2025-12-14 19:19:37,211 - INFO -   • output/correlation_matrices/tumor_corr_proto.npz
2025-12-14 19:19:37,211 - INFO -   • output/correlation_matrices/normal_corr_proto.npz
2025-12-14 19:19:37,211 - INFO -   • output/correlation_matrices/sample_info.json
2025-12-14 19:19:37,211 - INFO - 
2025-12-14 19:19:37,211 - INFO - Next step: python scripts/proto_02_differential.py
2025-12-14 19:19:37,211 - INFO - ============================================================
2025-12-14 19:19:38,221 - INFO - 
2025-12-14 19:19:38,221 - INFO - ============================================================
2025-12-14 19:19:38,221 - INFO - PROTOTYPE STEP 2: DIFFERENTIAL ANALYSIS
2025-12-14 19:19:38,221 - INFO - ============================================================
2025-12-14 19:19:38,221 - INFO - 
2025-12-14 19:19:38,223 - INFO - Step 1: Loading correlation matrices
2025-12-14 19:19:38,223 - INFO - ----------------------------------------
2025-12-14 19:19:38,223 - INFO - Loading correlation matrices from Step 1...
2025-12-14 19:19:43,674 - INFO - Tumor correlation: (13384, 13384)
2025-12-14 19:19:43,674 - INFO - Normal correlation: (13384, 13384)
2025-12-14 19:19:43,674 - INFO - Genes: 13384
2025-12-14 19:19:43,674 - INFO - Samples: 120 tumor + 40 normal
2025-12-14 19:19:43,674 - INFO - 
2025-12-14 19:19:43,674 - INFO - Step 2: Differential co-expression analysis (with efficient sampling)
2025-12-14 19:19:43,674 - INFO - ----------------------------------------
2025-12-14 19:19:43,674 - INFO - Computing differential co-expression WITH EFFICIENT SAMPLING...
2025-12-14 19:19:43,887 - INFO -   Analyzing 89,559,036 unique gene pairs
2025-12-14 19:19:43,887 - INFO -   FDR threshold: 0.05
2025-12-14 19:19:43,887 - INFO -   Min effect size: 0.1
2025-12-14 19:19:43,887 - INFO -   Volcano target points: 1,500,000
2025-12-14 19:19:43,887 - INFO -   Expected significant: ~34,569,787
2025-12-14 19:19:43,887 - INFO -   Expected non-significant: ~54,989,249
2025-12-14 19:19:43,887 - INFO -   Non-significant sampling probability: 0.0100
2025-12-14 19:19:43,887 - INFO -   Computing p-values (chunked)...
2025-12-14 19:19:47,201 - INFO -   Applying FDR correction...
2025-12-14 19:20:05,816 - INFO -   Collecting results with sampling...
2025-12-14 19:23:05,178 - INFO -   Collected 34,566,174 significant pairs
2025-12-14 19:23:05,180 - INFO -   Sampled 549,906 non-significant pairs
2025-12-14 19:23:05,180 - INFO -   Total volcano points: 35,116,080
2025-12-14 19:23:05,180 - INFO -   Actual sampling rate for non-sig: 0.0100
2025-12-14 19:23:05,180 - INFO -   Creating significant pairs DataFrame...
2025-12-14 19:25:51,720 - INFO -   Rewiring score (mean |Δr|): 0.443
2025-12-14 19:25:51,722 - INFO -   Creating volcano dataset DataFrame...
2025-12-14 19:28:32,417 - INFO - Downsampling volcano dataset (simple random sampling)...
2025-12-14 19:28:35,022 - INFO -   Before: 34,566,174 sig + 549,906 non = 35,116,080 total
2025-12-14 19:28:35,028 - INFO -   Target: 549,906 non-sig (all) + 950,094 sig (sampled)
2025-12-14 19:28:36,453 - INFO -   Sampled sig: 34,566,174 -> 950,094 (2.7%)
2025-12-14 19:28:36,712 - INFO -   After sampling: 1,500,000 total
2025-12-14 19:28:36,712 - INFO -   Final ratio: 950,094 sig (63.3%) + 549,906 non (36.7%)
2025-12-14 19:28:48,511 - INFO -   Mapping gene indices to names...
2025-12-14 19:29:05,214 - INFO - Saved volcano dataset to: output/differential_results/differential_pairs_volcano.tsv
2025-12-14 19:29:05,247 - INFO -   Size: 1,500,000 points (950,094 sig + 549,906 non-sig)
2025-12-14 19:29:05,538 - INFO -   Memory: 263.0 MB
2025-12-14 19:30:52,981 - INFO - Saved all significant pairs to: output/differential_results/differential_pairs_significant.tsv
2025-12-14 19:30:59,423 - INFO -   Size: 34,566,174 pairs (6303.9 MB)
2025-12-14 19:30:59,423 - INFO - 
2025-12-14 19:30:59,423 - INFO - Step 4: Differential connectivity analysis
2025-12-14 19:30:59,423 - INFO - ----------------------------------------
2025-12-14 19:30:59,423 - INFO - Computing differential connectivity per gene...
2025-12-14 19:30:59,423 - INFO -   Using threshold |r| ≥ 0.7
2025-12-14 19:31:04,512 - INFO - Connectivity computed for 13384 genes
2025-12-14 19:31:04,514 - INFO -   Max absolute delta: 5984.0
2025-12-14 19:31:04,514 - INFO -   Min absolute delta: 0.0
2025-12-14 19:31:04,515 - INFO -   Mean absolute delta: 1977.3
2025-12-14 19:31:04,515 - INFO -   Genes with connectivity gain: 853
2025-12-14 19:31:04,515 - INFO -   Genes with connectivity loss: 12,264
2025-12-14 19:31:04,536 - INFO - Saved connectivity to: output/differential_results/differential_connectivity.tsv
2025-12-14 19:31:04,536 - INFO - 
2025-12-14 19:31:04,536 - INFO - Step 5: Hub identification
2025-12-14 19:31:04,536 - INFO - ----------------------------------------
2025-12-14 19:31:04,536 - INFO - Identifying top 50 rewired hubs (mode: visual)...
2025-12-14 19:31:04,545 - INFO -   Visual mode: filtered to 702 hubs
2025-12-14 19:31:04,545 - INFO -   Tumor connectivity range: 80-500
2025-12-14 19:31:04,545 - INFO -   Normal connectivity min: 300
2025-12-14 19:31:04,545 - INFO -   Selected 50 hubs by visual score
2025-12-14 19:31:04,545 - INFO -   Tumor edges range: 81-387
2025-12-14 19:31:04,545 - INFO -   Normal edges range: 4773-5626
2025-12-14 19:31:04,545 - INFO -   Delta range: 4602-5468
2025-12-14 19:31:04,546 - INFO - Top 50 hubs identified by visual selection
2025-12-14 19:31:04,546 - INFO -   Top hub: ZKSCAN5 (|Δ| = 5468.0, direction: loss)
2025-12-14 19:31:04,546 - INFO -   Top hubs breakdown: 0 gains, 50 losses
2025-12-14 19:31:04,546 - INFO -   Tumor connectivity range: 81-387
2025-12-14 19:31:04,546 - INFO -   Normal connectivity range: 4773-5626
2025-12-14 19:31:04,549 - INFO - Saved top hubs to: output/differential_results/top_hubs.json
2025-12-14 19:31:04,549 - INFO - 
2025-12-14 19:31:04,549 - INFO - Step 6: Generating summary statistics
2025-12-14 19:31:04,549 - INFO - ----------------------------------------
2025-12-14 19:31:04,552 - INFO - Saved summary to: output/differential_results/summary_stats.json
2025-12-14 19:31:04,552 - INFO - 
2025-12-14 19:31:04,552 - INFO - KEY METRICS:
2025-12-14 19:31:04,553 - INFO -   • Significant pairs: 34,566,174
2025-12-14 19:31:04,553 - INFO -   • Rewiring score: 0.443
2025-12-14 19:31:04,553 - INFO -   • Hub selection mode: visual
2025-12-14 19:31:04,553 - INFO -   • Top hub: ZKSCAN5 (|Δ| = 5468.0, loss)
2025-12-14 19:31:04,553 - INFO -   • Volcano dataset: 1,500,000 points
2025-12-14 19:31:04,553 - INFO -   • Sampling rate (non-sig): 1.000%
2025-12-14 19:31:04,553 - INFO -   • Connectivity gains: 853 genes
2025-12-14 19:31:04,553 - INFO -   • Connectivity losses: 12,264 genes
2025-12-14 19:31:04,553 - INFO - 
2025-12-14 19:31:04,553 - INFO - ============================================================
2025-12-14 19:31:04,553 - INFO - STEP 2 COMPLETE
2025-12-14 19:31:04,553 - INFO - ============================================================
2025-12-14 19:31:04,553 - INFO - Total execution time: 686.3 seconds (11.4 minutes)
2025-12-14 19:31:04,553 - INFO - 
2025-12-14 19:31:04,553 - INFO - Outputs generated:
2025-12-14 19:31:04,553 - INFO -   • output/differential_results/differential_pairs_significant.tsv (all significant pairs, 34,566,174 rows)
2025-12-14 19:31:04,553 - INFO -   • output/differential_results/differential_pairs_volcano.tsv (optimized volcano dataset, 1,500,000 rows)
2025-12-14 19:31:04,553 - INFO -   • output/differential_results/differential_connectivity.tsv (connectivity results)
2025-12-14 19:31:04,553 - INFO -   • output/differential_results/top_hubs.json (top hubs)
2025-12-14 19:31:04,553 - INFO -   • output/differential_results/summary_stats.json (summary statistics)
2025-12-14 19:31:04,553 - INFO - 
2025-12-14 19:31:04,553 - INFO - Storage estimate:
2025-12-14 19:31:04,553 - INFO -   • Significant pairs: ~4147.9 MB
2025-12-14 19:31:04,553 - INFO -   • Volcano dataset: ~180.0 MB
2025-12-14 19:31:04,553 - INFO -   • Total Step 2 output: ~4327.9 MB
2025-12-14 19:31:04,553 - INFO - 
2025-12-14 19:31:04,553 - INFO - Next step: python scripts/proto_03_build_subgraphs.py
2025-12-14 19:31:04,553 - INFO - ============================================================
2025-12-14 19:31:05,545 - INFO - 
2025-12-14 19:31:05,545 - INFO - ============================================================
2025-12-14 19:31:05,545 - INFO - PROTOTYPE STEP 3: BUILD HUB SUBGRAPHS
2025-12-14 19:31:05,545 - INFO - ============================================================
2025-12-14 19:31:05,545 - INFO - 
2025-12-14 19:31:05,547 - INFO - Step 1: Loading top hubs from Step 2
2025-12-14 19:31:05,547 - INFO - ----------------------------------------
2025-12-14 19:31:05,547 - INFO - Loaded top 3 hubs:
2025-12-14 19:31:05,547 - INFO -   1. ZKSCAN5 (Δ = 5468.0)
2025-12-14 19:31:05,547 - INFO -   2. MARVELD2 (Δ = 5460.0)
2025-12-14 19:31:05,547 - INFO -   3. QRICH1 (Δ = 5309.0)
2025-12-14 19:31:05,547 - INFO - 
2025-12-14 19:31:05,547 - INFO - Step 2: Loading correlation matrices
2025-12-14 19:31:05,547 - INFO - ----------------------------------------
2025-12-14 19:31:05,547 - INFO - Loading tumor correlation...
2025-12-14 19:31:08,576 - INFO -   Tumor: (13384, 13384)
2025-12-14 19:31:08,576 - INFO - Loading normal correlation...
2025-12-14 19:31:11,277 - INFO -   Normal: (13384, 13384)
2025-12-14 19:31:11,277 - INFO - 
2025-12-14 19:31:11,277 - INFO - Step 3: Building full correlation networks
2025-12-14 19:31:11,277 - INFO - ----------------------------------------
2025-12-14 19:31:11,277 - INFO - Building tumor network...
2025-12-14 19:31:11,277 - INFO - Building network with threshold |r| ≥ 0.7...
2025-12-14 19:32:17,091 - INFO - Network built: 13384 nodes, 220186 edges
2025-12-14 19:32:17,092 - INFO - Building normal network...
2025-12-14 19:32:17,092 - INFO - Building network with threshold |r| ≥ 0.7...
2025-12-14 19:33:33,389 - INFO - Network built: 13384 nodes, 13365193 edges
2025-12-14 19:33:33,390 - INFO - 
2025-12-14 19:33:33,390 - INFO - Step 4: Extracting hub subgraphs
2025-12-14 19:33:33,390 - INFO - ----------------------------------------
2025-12-14 19:33:33,390 - INFO - Processing hub 1: ZKSCAN5
2025-12-14 19:33:33,390 - INFO -   Tumor condition:
2025-12-14 19:33:33,390 - INFO -   Limiting 158 neighbors to top 50 by edge weight
2025-12-14 19:33:33,393 - INFO -   Extracted subgraph: 51 nodes, 517 edges
2025-12-14 19:33:33,396 - INFO - Saved to: output/hub_subgraphs/ENSG00000196652.12|ZKSCAN5_tumor.pkl (17.0 KB)
2025-12-14 19:33:33,396 - INFO -   Normal condition:
2025-12-14 19:33:33,396 - INFO -   Limiting 5622 neighbors to top 50 by edge weight
2025-12-14 19:33:33,441 - INFO -   Extracted subgraph: 51 nodes, 1275 edges
2025-12-14 19:33:33,443 - INFO - Saved to: output/hub_subgraphs/ENSG00000196652.12|ZKSCAN5_normal.pkl (39.0 KB)
2025-12-14 19:33:33,443 - INFO - 
2025-12-14 19:33:33,443 - INFO - Processing hub 2: MARVELD2
2025-12-14 19:33:33,443 - INFO -   Tumor condition:
2025-12-14 19:33:33,443 - INFO -   Limiting 91 neighbors to top 50 by edge weight
2025-12-14 19:33:33,446 - INFO -   Extracted subgraph: 51 nodes, 812 edges
2025-12-14 19:33:33,447 - INFO - Saved to: output/hub_subgraphs/ENSG00000152939.17|MARVELD2_tumor.pkl (25.6 KB)
2025-12-14 19:33:33,447 - INFO -   Normal condition:
2025-12-14 19:33:33,447 - INFO -   Limiting 5546 neighbors to top 50 by edge weight
2025-12-14 19:33:33,517 - INFO -   Extracted subgraph: 51 nodes, 1275 edges
2025-12-14 19:33:33,518 - INFO - Saved to: output/hub_subgraphs/ENSG00000152939.17|MARVELD2_normal.pkl (39.0 KB)
2025-12-14 19:33:33,518 - INFO - 
2025-12-14 19:33:33,518 - INFO - Processing hub 3: QRICH1
2025-12-14 19:33:33,518 - INFO -   Tumor condition:
2025-12-14 19:33:33,518 - INFO -   Limiting 116 neighbors to top 50 by edge weight
2025-12-14 19:33:33,521 - INFO -   Extracted subgraph: 51 nodes, 692 edges
2025-12-14 19:33:33,522 - INFO - Saved to: output/hub_subgraphs/ENSG00000198218.11|QRICH1_tumor.pkl (22.1 KB)
2025-12-14 19:33:33,522 - INFO -   Normal condition:
2025-12-14 19:33:33,522 - INFO -   Limiting 5417 neighbors to top 50 by edge weight
2025-12-14 19:33:33,580 - INFO -   Extracted subgraph: 51 nodes, 1275 edges
2025-12-14 19:33:33,582 - INFO - Saved to: output/hub_subgraphs/ENSG00000198218.11|QRICH1_normal.pkl (39.0 KB)
2025-12-14 19:33:33,582 - INFO - 
2025-12-14 19:33:33,582 - INFO - ============================================================
2025-12-14 19:33:33,582 - INFO - STEP 3 COMPLETE
2025-12-14 19:33:33,582 - INFO - ============================================================
2025-12-14 19:33:33,582 - INFO - Total execution time: 148.0 seconds
2025-12-14 19:33:33,582 - INFO - 
2025-12-14 19:33:33,582 - INFO - Subgraphs created: 6 files
2025-12-14 19:33:33,582 - INFO -   • 3 hubs × 2 conditions (tumor/normal)
2025-12-14 19:33:33,582 - INFO -   • Saved to: output/hub_subgraphs
2025-12-14 19:33:33,582 - INFO - 
2025-12-14 19:33:33,582 - INFO - Next step: python scripts/proto_04_visualize.py
2025-12-14 19:33:33,582 - INFO - ============================================================
2025-12-14 19:33:38,505 - INFO - 
2025-12-14 19:33:38,505 - INFO - ============================================================
2025-12-14 19:33:38,505 - INFO - PROTOTYPE STEP 4: GENERATE VISUALIZATIONS
2025-12-14 19:33:38,505 - INFO - ============================================================
2025-12-14 19:33:38,505 - INFO - 
2025-12-14 19:33:38,507 - INFO - Step 1: Loading results from Steps 2-3
2025-12-14 19:33:38,507 - INFO - ----------------------------------------
2025-12-14 19:33:40,049 - INFO - Loaded optimized volcano dataset: 1,500,000 points
2025-12-14 19:33:40,054 - INFO -   - Significant in dataset: 950,094
2025-12-14 19:33:40,055 - INFO -   - Non-significant in dataset: 549,906
2025-12-14 19:34:00,396 - INFO - Loaded all significant pairs: 34,566,174 (for reference)
2025-12-14 19:34:00,407 - INFO - Loaded connectivity for 13,384 genes
2025-12-14 19:34:00,408 - INFO - Loaded top 3 hubs
2025-12-14 19:34:00,408 - INFO - 
2025-12-14 19:34:00,408 - INFO - Step 2: Creating volcano plot (smart sampling)
2025-12-14 19:34:00,408 - INFO - ----------------------------------------
2025-12-14 19:34:00,408 - INFO - Creating two-panel volcano plot...
2025-12-14 19:34:00,408 - INFO -   Using 1,500,000 sampled points
2025-12-14 19:34:00,490 - INFO -   Significant: 950,094 (63.3%)
2025-12-14 19:34:00,490 - INFO -   Non-significant: 549,906 (36.7%)
2025-12-14 19:34:00,697 - INFO -   Top panel: 125 sig + 0 non-sig
2025-12-14 19:34:00,738 - INFO -   Bottom panel: 949,969 sig + 549,906 non-sig
2025-12-14 19:34:02,155 - INFO - Two-panel volcano plot saved: output/visualizations/01_volcano_plot.png
2025-12-14 19:34:02,155 - INFO -   - Top panel: 125 points (y ≥ 20)
2025-12-14 19:34:02,155 - INFO -   - Bottom panel: 1,499,875 points (y < 20)
2025-12-14 19:34:02,155 - INFO -   - Gray points in bottom: 549,906 (FULLY VISIBLE!)
2025-12-14 19:34:02,155 - INFO - 
2025-12-14 19:34:02,155 - INFO - Step 3: Creating hub ranking bar chart
2025-12-14 19:34:02,155 - INFO - ----------------------------------------
2025-12-14 19:34:02,155 - INFO - Creating hub ranking plot (top 20)...
2025-12-14 19:34:02,574 - INFO - Hub ranking plot saved to: output/visualizations/02_hub_ranking_bar.png
2025-12-14 19:34:02,574 - INFO - 
2025-12-14 19:34:02,574 - INFO - Step 4: Creating connectivity scatter plot
2025-12-14 19:34:02,574 - INFO - ----------------------------------------
2025-12-14 19:34:02,574 - INFO - Creating connectivity scatter plot...
2025-12-14 19:34:03,017 - INFO - Connectivity scatter saved to: output/visualizations/03_connectivity_scatter.png
2025-12-14 19:34:03,017 - INFO - 
2025-12-14 19:34:03,017 - INFO - Step 5: Creating hub comparison grid
2025-12-14 19:34:03,017 - INFO - ----------------------------------------
2025-12-14 19:34:03,017 - INFO - Creating hub comparison grid (2×3 layout)...
2025-12-14 19:34:03,017 - INFO -   This is THE VISUAL PROOF of network rewiring!
2025-12-14 19:34:03,108 - INFO -   Plotting hub 1: ZKSCAN5
2025-12-14 19:34:03,131 - INFO -   Plotting hub 2: MARVELD2
2025-12-14 19:34:03,147 - INFO -   Plotting hub 3: QRICH1
2025-12-14 19:34:04,878 - INFO - Hub comparison grid saved to: output/visualizations/04_hub_comparison_grid.png
2025-12-14 19:34:04,878 - INFO -   KEY FIGURE: This is the main visualization for demonstration!
2025-12-14 19:34:04,878 - INFO - 
2025-12-14 19:34:04,878 - INFO - ============================================================
2025-12-14 19:34:04,878 - INFO - STEP 4 COMPLETE - ALL VISUALIZATIONS GENERATED
2025-12-14 19:34:04,878 - INFO - ============================================================
2025-12-14 19:34:04,878 - INFO - Total execution time: 26.4 seconds
2025-12-14 19:34:04,878 - INFO - 
2025-12-14 19:34:04,878 - INFO - Visualizations saved:
2025-12-14 19:34:04,878 - INFO -   1. output/visualizations/01_volcano_plot.png (optimized smart sampling)
2025-12-14 19:34:04,879 - INFO -   2. output/visualizations/02_hub_ranking_bar.png
2025-12-14 19:34:04,879 - INFO -   3. output/visualizations/03_connectivity_scatter.png
2025-12-14 19:34:04,879 - INFO -   4. output/visualizations/04_hub_comparison_grid.png  KEY FIGURE
2025-12-14 19:34:04,879 - INFO - 
2025-12-14 19:34:04,879 - INFO - Smart Sampling Statistics:
2025-12-14 19:34:04,879 - INFO -   • Volcano dataset points: 1,500,000
2025-12-14 19:34:04,879 - INFO -   • Significant points in plot: 950,094
2025-12-14 19:34:04,879 - INFO -   • Full analysis significant: 34,566,174
2025-12-14 19:34:04,879 - INFO -   • Storage saved: ~10567 MB
2025-12-14 19:34:04,879 - INFO - 
2025-12-14 19:34:04,879 - INFO - PROTOTYPE VALIDATION COMPLETE!
2025-12-14 19:34:04,879 - INFO - ============================================================
2025-12-14 19:34:04,879 - INFO - 
2025-12-14 19:34:04,879 - INFO - Next steps:
2025-12-14 19:34:04,879 - INFO -   • Review visualizations in output/visualizations/
2025-12-14 19:34:04,880 - INFO -   • Check summary_stats.json for quantitative metrics
2025-12-14 19:34:04,880 - INFO -   • Use 04_hub_comparison_grid.png for thesis defense
2025-12-14 19:34:04,880 - INFO -   • Proceed to full pipeline if results are satisfactory
2025-12-14 19:34:04,880 - INFO - 
2025-12-14 19:34:04,880 - INFO - ============================================================
